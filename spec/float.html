
<!DOCTYPE html>
<html lang="ja-JP">
<!--
    Copyright (c) 1999-2022 by the D Language Foundation
    All Rights Reserved.
    https://dlang.org/foundation_overview.html
  -->
<head>
<meta charset="utf-8">
<meta name="keywords" content="D programming language">
<meta name="description" content="D Programming Language">
<title>浮動小数点数 - D言語 非公式日本語</title>

<link rel="stylesheet" href="../css/codemirror.css">
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/print.css" media="print">
<link rel="shortcut icon" href="../favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=10.0">

</head>
<body id='浮動小数点数' class='doc'>
<script type="text/javascript">document.body.className += ' have-javascript'</script>
<div id="top"><div class="helper"><div class="helper expand-container">    <div class="logo"><a href=".."><img id="logo" alt="D Logo" src="../images/dlogo.svg"></a></div>
    <a href="../menu.html" title="Menu" class="hamburger expand-toggle"><span>Menu</span></a>
    
<div id="cssmenu"><ul>    <li><a href='https://tour.dlang.org/tour/ja/welcome/welcome-to-d'><span>学ぶ</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='../documentation.html'><span>ドキュメント</span></a>
      
<ul class='expand-content'>    <li><a href='../spec/spec.html'>言語仕様 リファレンス</a></li>
    <li><a href='../phobos/index.html'>ライブラリ リファレンス</a></li>
    <li><a href='../dmd.html'>コマンドライン リファレンス</a></li>
    <li class="menu-divider"><a href='../comparison.html'>機能概要</a></li>
    <li><a href='../articles/index.html'>記事[Articles]</a></li>
 </ul></li>
    <li><a href='../download.html'><span>ダウンロード</span></a></li>
    <li><a href='https://code.dlang.org'><span>パッケージ</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='../community.html'><span>コミュニティ</span></a>
      
<ul class='expand-content'>    <li><a href='https://dlang.org/blog'>ブログ</a></li>
    <li><a href='../orgs-using-d.html'>利用実績</a></li>
    <li><a href='https://twitter.com/search?q=%23dlang'>Twitter</a></li>
    <li><a href='../calendar.html'>カレンダー</a></li>
    <li class="menu-divider"><a href='https://forum.dlang.org'>フォーラム</a></li>
    <li><a href='irc://irc.libera.chat/d'>IRC</a></li>
    <li><a href='https://discord.gg/bMZk9Q4'>Discord</a></li>
    <li><a href='https://wiki.dlang.org'>Wiki</a></li>
    <li class="menu-divider"><a href='https://github.com/dlang'>GitHub</a></li>
    <li><a href='https://dlang.org/bugstats.html'>Issues</a></li>
    <li><a href='https://wiki.dlang.org/Get_involved'>参加するには</a></li>
    <li class="menu-divider"><a href='https://dlang.org/foundation/contributors.html'>貢献している方々</a></li>
    <li><a href='../foundation/index.html'>D言語財団</a></li>
    <li><a href='../security.html'>セキュリティ</a></li>
    <li><a href='../foundation/donate.html'>寄付での貢献</a></li>
    <li><a href='../foundation/sponsors.html'>スポンサー</a></li>
 </ul></li>
    <li class='expand-container'><a class='expand-toggle' href='../resources.html'><span>リソース</span></a>
      
<ul class='expand-content'>    <li><a href='https://tour.dlang.org/tour/ja/welcome/welcome-to-d'>D言語ツアー</a></li>
    <li><a href='https://wiki.dlang.org/Books'>書籍</a></li>
    <li><a href='https://wiki.dlang.org/Tutorials'>チュートリアル</a></li>
    <li class="menu-divider"><a href='https://wiki.dlang.org/Development_tools'>ツール</a></li>
    <li><a href='https://wiki.dlang.org/Editors'>エディタ</a></li>
    <li><a href='https://wiki.dlang.org/IDEs'>IDE</a></li>
    <li><a href='https://run.dlang.io'>run.dlang.io</a></li>
    <li><a href='http://rainers.github.io/visuald/visuald/StartPage.html'>Visual D</a></li>
    <li class="menu-divider"><a href='../acknowledgements.html'>謝辞</a></li>
    <li><a href='../dstyle.html'>コーディングスタイル</a></li>
    <li><a href='../glossary.html'>用語集</a></li>
    <li><a href='../sitemap.html'>サイトマップ</a></li>
 </ul></li>
</ul></div>
    <div class="search-container expand-container">        <a href="../search.html" class="expand-toggle" title="Search"><span>Search</span></a>
        
    <div id="search-box">        <form method="get" action="https://google.com/search">
            <input type="hidden" id="domains" name="domains" value="dlang.org">
            <input type="hidden" id="sourceid" name="sourceid" value="google-search">
            <span id="search-query"><input id="q" name="q" placeholder="Search"></span><span id="search-dropdown"><span class="helper">                <select id="sitesearch" name="sitesearch" size="1">
                    <option value="dlang.org">Entire Site</option>
                    <option selected value="dlang.org/spec">Language</option>
                    <option  value="dlang.org/phobos">Library</option>
                    <option  value="forum.dlang.org">Forums</option>
                    
                </select>
            </span></span><span id="search-submit"><button type="submit"><i class="fa fa-search"></i><span>go</span></button></span>
        </form>
    </div>
    </div>
</div></div></div>

<div class="container">    
<div class="subnav-helper"></div> <div class="subnav">    <div class="head"><h2>言語仕様 リファレンス</h2> <p class="subnav-duplicate"><a href="../spec/spec.html">table of contents</a></p></div>
    <ul>        <li><a href='            ../spec/intro.html'>はじめに[Introduction]</a></li><li><a href='            ../spec/lex.html'>字句の構成[Lexical]</a></li><li><a href='            ../spec/grammar.html'>文法[Grammar]</a></li><li><a href='            ../spec/module.html'>モジュール[Modules]</a></li><li><a href='            ../spec/declaration.html'>宣言[Declarations]</a></li><li><a href='            ../spec/type.html'>型[Types]</a></li><li><a href='            ../spec/property.html'>プロパティ[Properties]</a></li><li><a href='            ../spec/attribute.html'>属性[Attributes]</a></li><li><a href='            ../spec/pragma.html'>プラグマ[Pragmas]</a></li><li><a href='            ../spec/expression.html'>式[Expressions]</a></li><li><a href='            ../spec/statement.html'>文[Statements]</a></li><li><a href='            ../spec/arrays.html'>配列[Arrays]</a></li><li><a href='            ../spec/hash-map.html'>連想配列[Associative Arrays]</a></li><li><a href='            ../spec/struct.html'>構造体と共用体</a></li><li><a href='            ../spec/class.html'>クラス[Classes]</a></li><li><a href='            ../spec/interface.html'>インターフェース[Interfaces]</a></li><li><a href='            ../spec/enum.html'>列挙型[Enums]</a></li><li><a href='            ../spec/const3.html'>型修飾子[Type Qualifiers]</a></li><li><a href='            ../spec/function.html'>関数[Functions]</a></li><li><a href='            ../spec/operatoroverloading.html'>演算子オーバーロード</a></li><li><a href='            ../spec/template.html'>テンプレート[Templates]</a></li><li><a href='            ../spec/template-mixin.html'>ミックスイン[Template Mixins]</a></li><li><a href='            ../spec/contracts.html'>契約[Contract Programming]</a></li><li><a href='            ../spec/version.html'>条件コンパイル</a></li><li><a href='            ../spec/traits.html'>特性[Traits]</a></li><li><a href='            ../spec/errors.html'>エラー処理[Error Handling]</a></li><li><a href='            ../spec/unittest.html'>単体テスト[Unit Tests]</a></li><li><a href='            ../spec/garbage.html'>ガベージコレクション</a></li><li><a href='            ../spec/float.html'>浮動小数点数[Floating Point]</a></li><li><a href='            ../spec/iasm.html'>インラインアセンブラ</a></li><li><a href='            ../spec/ddoc.html'>ドキュメント生成</a></li><li><a href='            ../spec/interfaceToC.html'>Cとの連携[Interfacing to C]</a></li><li><a href='            ../spec/cpp_interface.html'>C++との連携[Interfacing to C++]</a></li><li><a href='            ../spec/objc_interface.html'>Objective-Cとの連携</a></li><li><a href='            ../spec/portability.html'>移植性[Portability Guide]</a></li><li><a href='            ../spec/entity.html'>名前付き文字</a></li><li><a href='            ../spec/memory-safe-d.html'>メモリ安全性[Memory Safety]</a></li><li><a href='            ../spec/abi.html'>ABI[Application Binary Interface]</a></li><li><a href='            ../spec/simd.html'>ベクトル拡張[Vector Extensions]</a></li><li><a href='            ../spec/betterc.html'>Better C</a></li><li><a href='            ../spec/importc.html'>Cのインポート[Import C]</a></li><li><a href='            ../spec/ob.html'>@live[Live Functions]
        </a></li>
    </ul>
</div>
    <div class="hyphenate" id="content">        
<div id="tools"><div >	<div class="tip smallprint">		<a href="https://github.com/devmynote/dlang.org/edit/master/spec/float.dd">ページの改善</a>
		<div >		    いますぐフォークしてオンライン編集し、このページのプルリクエストを送信します。
			Github へのログインが必要です。 これは小さな変更に適しています。
			大きな変更を加えたい場合は、通常の cloneの使用をお勧めします。
		</div>
	</div>
	<div class="tip smallprint">日本語版について
		<div >			個人的な学習のために、dlang.orgを翻訳したサイトです。
			翻訳に際して、様々なサイトを参考にしています。
		</div>
	</div>
</div></div>
        <h1>浮動小数点数</h1>
        
<style>    body { counter-reset: h1 29; counter-increment: h1 -1; }
    h1 { counter-reset: h2 h3 p; }
    h2 { counter-reset: h3 h4 p; }
    h3 { counter-reset: h4 p; }
    h4 { counter-reset: p; }
    h1::before {
        counter-increment: h1;
        content: counter(h1) ". ";
    }
    .hyphenate h2::before {
        counter-increment: h2;
        content: counter(h1) "." counter(h2) " ";
    }
    h3::before {
        counter-increment: h3;
        content: counter(h1) "." counter(h2) "." counter(h3) " ";
    }
    h4::before {
        counter-increment: h4;
        content: counter(h1) "." counter(h2) "." counter(h3) "." counter(h4) " ";
    }
    p::before, .spec-boxes::before {
        counter-increment: p;
        content: counter(p) ". ";
    }
    h1::before, h2::before, h3::before, h4::before, p::before, .spec-boxes::before
    {
        color: #999;
        font-size: 80%;
        margin-right: 0.25em;
    }
</style>
        <div class="blankline"></div>
<div class="blankline"></div>
<div class="blankline"></div>
<div class="page-contents quickindex">    <div class="page-contents-header">        <b>Contents</b>
    </div>
    <ol>    <li><a href="#fp_intermediate_values">浮動小数点の内部の値</a></li>
    <li><a href="#fp_const_folding">浮動小数点定数の折りたたみ構造</a></li>
    <li><a href="#rounding_control">丸めの制御</a></li>
    <li><a href="#exception_flags">例外フラグ</a></li>
    <li><a href="#floating-point-transformations">浮動小数点の変換</a></li>
</ol>
</div>
<div class="blankline"></div>
<h2><a class="anchor" title="Permalink to this section" id="fp_intermediate_values" href="#fp_intermediate_values">浮動小数点の内部の値</a></h2>
<div class="blankline"></div>
        <p>For floating-point operations and expression intermediate values,
        a greater precision can be used than the type of the
        expression.
        Only the minimum precision is set by the types of the
        operands, not the maximum. <b>Implementation Note:</b> On Intel
        x86 machines, for example,
        it is expected (but not required) that the intermediate
        calculations be done to the full 80 bits of precision
        implemented by the hardware.
        </p>
<div class="blankline"></div>
        <p>Execution of floating-point expressions may yield a result of greater precision than dictated
        by the source.</p>
<div class="blankline"></div>
<h2><a class="anchor" title="Permalink to this section" id="fp_const_folding" href="#fp_const_folding">浮動小数点定数の折りたたみ構造</a></h2>
<div class="blankline"></div>
        <p>Regardless of the type of the operands, floating-point
        constant folding is done in <span class="d_inlinecode donthyphenate notranslate">real</span> or greater precision.
        It is always done following <a href="https://standards.ieee.org/standard/754-2019.html">IEEE-754</a> rules and round-to-nearest
        is used.</p>
<div class="blankline"></div>
        <p>Floating-point constants are internally represented in
        the implementation in at least <span class="d_inlinecode donthyphenate notranslate">real</span> precision, regardless
        of the constant's type. The extra precision is available for
        constant folding. Committing to the precision of the result is
        done as late as possible in the compilation process. For example:</p>
<div class="blankline"></div>
<pre class="d_code notranslate"><span class="d_keyword">const</span> <span class="d_keyword">float</span> f = 0.2f;
writeln(f - 0.2);
</pre>
        <p>will print 0. A non-const static variable's value cannot be
        propagated at compile time, so:</p>
<div class="blankline"></div>
<pre class="d_code notranslate"><span class="d_keyword">static</span> <span class="d_keyword">float</span> f = 0.2f;
writeln(f - 0.2);
</pre>
        <p>will print 2.98023e-09. Hex floating-point constants can also
        be used when specific floating-point bit patterns are needed that
        are unaffected by rounding. To find the hex value of 0.2f:</p>
<div class="blankline"></div>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.stdio;

<span class="d_keyword">void</span> main()
{
    writefln(<span class="d_string">"%a"</span>, 0.2f);
}
</pre>
        <p>which is 0x1.99999ap-3. Using the hex constant:</p>
<div class="blankline"></div>
<pre class="d_code notranslate"><span class="d_keyword">const</span> <span class="d_keyword">float</span> f = 0x1.99999ap-3f;
writeln(f - 0.2);
</pre>
<div class="blankline"></div>
        <p>prints 2.98023e-09.</p>
<div class="blankline"></div>
        <p>Different compiler settings, optimization settings,
        and inlining settings can affect opportunities for constant
        folding, therefore the results of floating-point calculations may differ
        depending on those settings.</p>
<div class="blankline"></div>
<h2><a class="anchor" title="Permalink to this section" id="rounding_control" href="#rounding_control">丸めの制御</a></h2>
<div class="blankline"></div>
        <p>IEEE 754 floating-point arithmetic includes the ability to set 4
        different rounding modes.
        These are accessible via the functions in <span class="d_inlinecode donthyphenate notranslate">core.stdc.fenv</span>.
        </p>
<div class="blankline"></div>
        <p>If the floating-point rounding mode is changed within a function,
        it must be restored before the function exits. If this rule is violated
        (for example, by the use of inline asm), the rounding mode used for
        subsequent calculations is undefined.
        </p>
<div class="blankline"></div>
<div class="blankline"></div>
<h2><a class="anchor" title="Permalink to this section" id="exception_flags" href="#exception_flags">例外フラグ</a></h2>
<div class="blankline"></div>
        <p>IEEE 754 floating-point arithmetic can set several flags based on what
        happened with a
        computation:</p>
<div class="blankline"></div>
        <table>        <tr><td><span class="d_inlinecode donthyphenate notranslate">FE_INVALID</span></td></tr>
        <tr><td><span class="d_inlinecode donthyphenate notranslate">FE_DENORMAL</span></td></tr>
        <tr><td><span class="d_inlinecode donthyphenate notranslate">FE_DIVBYZERO</span></td></tr>
        <tr><td><span class="d_inlinecode donthyphenate notranslate">FE_OVERFLOW</span></td></tr>
        <tr><td><span class="d_inlinecode donthyphenate notranslate">FE_UNDERFLOW</span></td></tr>
        <tr><td><span class="d_inlinecode donthyphenate notranslate">FE_INEXACT</span></td></tr>
        </table>
<div class="blankline"></div>
        <p>These flags can be set/reset via the functions in <span class="d_inlinecode donthyphenate notranslate">core.stdc.fenv</span>.</p>
<div class="blankline"></div>
<h2><a class="anchor" title="Permalink to this section" id="floating-point-transformations" href="#floating-point-transformations">浮動小数点の変換</a></h2>
<div class="blankline"></div>
        <p>An implementation may perform transformations on
        floating-point computations in order to reduce their strength.
        </p>
<div class="blankline"></div>
        <p>Not all transformations are valid: The following
        transformations of floating-point expressions
        are not allowed because under IEEE rules they could produce
        different results.
        </p>
<div class="blankline"></div>
        <center><table><caption>Disallowed Floating-Point Transformations</caption>        <tr><th class="donthyphenate"><b>transformation</b></th><th class="donthyphenate"><b>comments</b></th></tr>
        <tr><td>        <i>x</i> + 0 &rarr; <i>x</i> </td><td>not valid if <i>x</i> is -0
        </td></tr>
        <tr><td>        <i>x</i> - 0 &rarr; <i>x</i> </td><td>not valid if <i>x</i> is &plusmn;0 and rounding is towards -&infin;
        </td></tr>
        <tr><td>        -<i>x</i> &harr; 0 - <i>x</i> </td><td>not valid if <i>x</i> is +0
        </td></tr>
        <tr><td>        <i>x</i> - <i>x</i> &rarr; 0 </td><td>not valid if <i>x</i> is NaN or &plusmn;&infin;
        </td></tr>
        <tr><td>        <i>x</i> - <i>y</i> &harr; -(<i>y</i> - <i>x</i>) </td><td>not valid because (1-1=+0) whereas -(1-1)=-0
        </td></tr>
        <tr><td>        <i>x</i> * 0 &rarr; 0 </td><td>not valid if <i>x</i> is NaN or &plusmn;&infin;
        </td></tr>

        <tr><td>        <i>x</i> / <i>c</i> &harr; <i>x</i> * (1/<i>c</i>) </td><td>valid if (1/<i>c</i>) yields an e<i>x</i>act result
        </td></tr>
        <tr><td>        <i>x</i> != <i>x</i> &rarr; false </td><td>not valid if <i>x</i> is a NaN
        </td></tr>
        <tr><td>        <i>x</i> == <i>x</i> &rarr; true </td><td>not valid if <i>x</i> is a NaN
        </td></tr>
        <tr><td>        <i>x</i> !<i>op</i> <i>y</i> &harr; !(<i>x</i> <i>op</i> <i>y</i>) </td><td>not valid if <i>x</i> or <i>y</i> is a NaN
        </td></tr>
        </table></center>
<div class="blankline"></div>
        <p>Of course, transformations that would alter side effects are also
        invalid.</p>
<div class="blankline"></div>

<div style="float: left"><i class="fa fa-angle-left" aria-hidden="true"></i> <a href="../spec/garbage.html">ガベージコレクション[Garbage Collection]</a></div>
<div style="float: right"><a href="../spec/iasm.html">インラインアセンブラ[D x86 Inline Assembler]</a> <i class="fa fa-angle-right" aria-hidden="true"></i></div>
<div style="clear:both"></div>



        <div class="smallprint" id="copyright">Copyright &copy; 1999-2022 by the <a href="../foundation_overview.html">D Language Foundation</a> | Page generated by
<a href="../spec/ddoc.html">Ddoc</a> on Sun Nov 20 02:56:51 2022
</div>
    </div>
</div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">window.jQuery || document.write('\x3Cscript src="../js/jquery-1.7.2.min.js">\x3C/script>');</script>
    <script type="text/javascript" src="../js/dlang.js"></script>
    
    <script type="text/javascript" src="../js/codemirror-compressed.js"></script>
    <script type="text/javascript" src="../js/run.js"></script>


<script type="text/javascript" src="../js/listanchors.js"></script>
<script type="text/javascript">jQuery(document).ready(addVersionSelector);</script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
</body>
</html>
